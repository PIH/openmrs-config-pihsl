<htmlform id="mch-triage-form"
          formUuid="ae39663d-c248-4cee-b48e-5eb226f74e47"
          formName="MCOE Triage"
          formEncounterType="41911448-71a1-43d7-bba8-dc86339850da"
          formVersion="1.0">

    <postSubmissionAction class="org.openmrs.module.pihcore.htmlformentry.action.AddPatientToQueueAction"/>
    <macros>
        <macro key="mcoeTriageLocation" value="f85feffc-fe54-4648-aa14-01ed6d30b943"/>
    </macros>

    <style type="text/css">
        #who-when-where {
            margin-bottom: 6px;
            border-bottom: 1px solid #ccc;
        }

        #who-when-where p {
            display: inline-block;
            padding-right: 20px;
        }

        #where > input[type=text] {
            display: inline-block;
        }

        .field-error {
            color: #ff6666;
            font-size: 1.1em;
            display: block;
        }

        #data-collection {
            display: inline-block;
            width: 58%;
            vertical-align: top;
        }

        #mch-triage-form, .exam input[type="checkbox"] {
            margin: 0px 5px; /* changed values to vertical, horizontal */
            top:5px;         /* added to offset the checkbox position to line up */
        }

        .exam label { /*new definition to override labels inside section-containers*/
            margin: 0px;
        }

        .row-symptom {
            margin-top: 20px;
        }

        .five-columns, .four-columns, .three-columns, .two-columns {
            display: table;
            height: 100%;
            width: 100%;
        }

        .two-columns > div {
            display: table-cell;
            width: 50%;
        }

        .three-columns > div {
            display: table-cell;
            width: 33%;
        }

        .four-columns > div {
            display: table-cell;
            width: 25%;
        }
    </style>

    <ifMode mode="VIEW" include="false">
        <script type="text/javascript">
            jq(function() {
                console.log("viewMode = false");

                beforeSubmit.push(function() {
                    console.log("beforeSubmit");
                    return true;
                });

            });
        </script>

        <script type="text/javascript">
            jq(document).ready(function() {

                jq('.normalObs').change(function(event) {
                // get the Obs checkbox value
                    var firstCheckbox = jq(this).children(":checkbox:first").prop('checked');
                    if (firstCheckbox == true) {
                        var parentDiv = jq(this).closest('.exam');
                        if (parentDiv != null) {
                            jq(parentDiv).find('.abnormalObs').each(function(index, element) {
                                jq(this).children(":checkbox:first").prop('checked', false);
                            });
                        }
                    }
                });

                jq('.abnormalObs').change(function(event) {
                    var firstCheckbox = jq(this).children(":checkbox:first").prop('checked');
                    if (firstCheckbox == true) {
                        var parentDiv = jq(this).closest('.exam');
                        if (parentDiv != null) {
                            jq(parentDiv).find('.normalObs').each(function(index, element) {
                                jq(this).children(":checkbox:first").prop('checked', false);
                            });
                        }
                    }
                });

            // handlers for next and submit buttons, see nextAndSubmitButtons.js
            // setUpNextAndSubmitButtons();

            });
        </script>
    </ifMode>

    <ifMode mode="VIEW" include="false">
        <h2><uimessage code="National Obstretic Triage and Treatment Form"/></h2>
            <div id="who-when-where">
                <p id="who">
                    <label><uimessage code="emr.patientDashBoard.providerRequired"/></label>
                    <span><encounterProviderAndRole default="currentUser" encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05" required="true"/></span>
                </p>
                <p id="where">
                    <label><uimessage code="emr.locationRequired"/></label>
                    <span><encounterLocation required="true" default="$mcoeTriageLocation" tags="MCH Triage Location"/></span>
                </p>
                <p id="when">
                    <label><uimessage code="emr.patientDashBoard.date"/></label>
                    <span><encounterDate id="encounterDate" default="now" showTime="false"/></span>
                </p>
            </div>
    </ifMode>

    <div class="row">
        <div class="col-sm-3">
            <h3 class="panel-title">Evaluation</h3>
        </div>
        <div class="col-sm-3" style="background-color: #83d183;">
            <h3 class="panel-title" style="white-space: pre-line">Non-urgent
                (Green: 4 hours)</h3>
        </div>
        <div class="col-sm-3" style="background-color: #f8ed62;">
            <h3 class="panel-title" style="white-space: pre-line">Urgent
            (Yellow: 30 minutes)</h3>
        </div>
        <div class="col-sm-3" style="background-color: #ff5252;">
            <h3 class="panel-title" style="white-space: pre-line">Emergent
            (Red: Immediately)</h3>
        </div>
    </div>

    <div class="four-columns exam">
        <div>
            <label>Airway</label>
        </div>
        <div>
            <obs class="normalObs" conceptId="PIH:20030" style="checkbox"
                 answerConceptId="PIH:20032" answerCode="Patent"/>
        </div>
        <div>
        </div>
        <div>
            <obs class="abnormalObs" conceptId="PIH:20030" style="checkbox"
                 answerConceptId="CIEL:164348" answerCode="Obstructed"/>
        </div>
    </div>

    <br/>

    <div class="four-columns exam">
        <div>
            <label>Disability</label>
        </div>
        <div>
            <obs class="normalObs" conceptId="CIEL:162558" style="checkbox"
                 answerConceptId="CIEL:160282" answerCode="Alert"/>
        </div>
        <div>
            <repeat>
                <template>
                    <obs class="abnormalObs" conceptId="CIEL:162558" style="checkbox"
                         answerConceptId="{cId}" />
                </template>
                <render cId="CIEL:139081" labelTag="Severe headache" />
                <render cId="CIEL:118938" labelTag="Blurred vision" />
            </repeat>
        </div>
        <div>
            <repeat>
                <template>
                    <obs class="abnormalObs" conceptId="CIEL:162558" style="checkbox"
                         answerConceptId="{cId}" />
                </template>
                <render cId="CIEL:113054" labelTag="Convulsing" />
                <render cId="CIEL:144576" labelTag="Coma" />
            </repeat>
        </div>
    </div>

    <!--
    <br/>
    <br/>
    <div class="row">
        <div class="col-sm-6">
            <h3 class="panel-title">Referral</h3>
            <obs conceptId="CIEL:1272" id="referToService"
                 answerConceptIds="PIH:6259,PIH:6261,PIH:7831,PIH:10377,PIH:15035,PIH:15036,PIH:15039,PIH:15038,PIH:15037"
                 answerCodes="Antenatal Ward,Postnatal Ward,Pre-Op/PACU,Labour and Delivery,MCCU,NICU,Pre-Op/PACU,Post-Op,Loss Ward"
                 style="radio"
                 answerSeparator="&lt;br /&gt;"/>
        </div>
        <div class="col-sm-6">
            <label>Priority</label>
            <obs conceptId="PIH:12842"
                 style="radio"
                 id="priority"
                 answerConceptIds="CIEL:1115,PIH:Emergency"
                 answerCodes="Normal,Emergency"
                 answerSeparator=" "/>
        </div>
    </div>
    <br/>
    <br/>
    -->

    <ifMode mode="VIEW" include="false">
        <div id="buttons">
            <button class="submitButton confirm right" onclick="submitHtmlForm()"><uimessage code="mirebalais.save"/><i class="icon-spinner icon-spin icon-2x" style="display: none; margin-left: 10px;"></i></button>
            <button type="button" class="cancel"><uimessage code="emr.cancel"/></button>
        </div>
    </ifMode>
</htmlform>