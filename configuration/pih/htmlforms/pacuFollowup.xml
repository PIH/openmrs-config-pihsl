<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http//license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->

<htmlform id="pacu-followup" class="simple-form-ui" formUuid="43b275f0-6e20-4538-ba94-19df332d4f76"
          formName="PACU Followup"
          formEncounterType="6f2df970-6e3e-4898-9a34-9d9e8955c3eb" formVersion="1.0">

    <postSubmissionAction class="org.openmrs.module.pihcore.htmlformentry.action.ApplyDispositionAction"/>

    <style type="text/css">
        .simple-form-ui input {
            min-width: 80%
        }

        form fieldset {
            min-width: 90%
        }

        #encounterDate input {
            min-width: 15%
        }

        textarea {
            overflow-y: hidden;
            padding-top: 1.1em;
        }

        @media print {
            .print-form-datestamps { display: block !important }
            button.cancel, button.submit { display: none }
            label { font-weight: bold }
            label[for] { font-weight: normal } /* refers to the radio set label */
        }

        .section-container {
            background: #F2F2F2;
            box-shadow: 3px 3px 3px 1px rgba(0, 0, 0, 0.2);
            padding: 10px 5px 10px 15px;
            line-height: 1.5em; /*add this for vertical spacing between elements*/
        }

        .section-container input[type="checkbox"] {
            margin: 0px 5px; /*changed values to vertical, horizontal*/
            top:5px; /*added to offset the checkbox position to line up*/
        }

        .section-container label { /*new definition to override labels inside section-containers*/
            margin: 0px;
        }

        .section {
            width: 100%;
        }

        .provider-grid {
            display: inline-grid;
            grid-template-columns: 400px 400px;
            background-color: #F2F2F2;
        }

        .provider-grid > div {
            padding-left: 5px;
            border: none;
        }

        .list-inline label, .list-inline input[type="radio"], .list-inline span,
        .list-inline-wide label, .list-inline-wide input[type="radio"], .list-inline-wide span,
        .list-inline-extra-wide label, .list-inline-extra-wide input[type="radio"], .list-inline-extra-wide span {
            display: inline-block;
            float: none;
        }

        .list-inline label:first-child {
            width: 220px;
        }

        .list-inline-wide label:first-child {
            width: 320px;
        }

        .list-inline-extra-wide label:first-child {
            width: 420px;
        }

        .four-columns, .three-columns, .two-columns {
            display: table;
            height: 100%;
            width: 100%;
        }

        .two-columns > div {
            display: table-cell;
            width: 50%;
        }
    </style>

    <script type="text/javascript">

        jq(function() {

            // make text areas expand based on content (this allows us to avoid scrollbars and thereby facilitate printing)
            jq('#post-op-surgical-note').on( 'keyup', 'textarea', function (){
                jq(this).height( 0 );
                jq(this).height( this.scrollHeight );
                });

            jq('#post-op-surgical-note').find( 'textarea' ).keyup();

        });

    </script>

    <ifMode mode="VIEW" include="false" >
        <h2>
            <label>
                <uimessage code="Post-anesthesia care unit (PACU) Followup"/>
            </label>
        </h2>
    </ifMode>

    <div class="print-form-datestamps" style="display:none">
        <p><uimessage code="created_on"/>:
            <lookup complexExpression="$form.dateCreated"/>
        </p>
        <p><uimessage code="last_updated_on"/>:
            <lookup complexExpression="$form.dateChanged"/>
        </p>
        <p><uimessage code="printed_on"/>:
            <lookup complexExpression="$formGeneratedDatetime"/>
        </p>
    </div>

    <section id="service-team" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Service team">
        <div class="section-container">
            <p class="date-one-line">
                <label>
                    <uimessage code="Admission date/time"/>
                </label>
                <!-- This could be "Admission date-time (PIH:12240)" -->
                <encounterDate id="encounterDate" showTime="true" default="now"/>
            </p>

            <p>
                <label>
                    <uimessage code="Location"/>
                </label>
                <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"
                                   tags="PACU Location"/>
            </p>

            <p>
                <!-- Attending surgeon -->
                <label>
                    <uimessage code="Surgeon"/>
                </label>
                <encounterProviderAndRole encounterRole="9b135b19-7ebe-4a51-aea2-69a53f9383af"
                                          providerRoles="3182ee51-b895-4804-a342-5f261e995222,556ceee6-d899-43d4-a98b-7973ebc85b75,2fa6f8da-aa58-11e8-98d0-529269fb1459"
                                          autocompleteProvider="true" required="false"/>
            </p>

            <p>
                <!-- Anesthesiologists -->
                <label>
                    <uimessage code="Anesthesiologist"/>
                </label>
                <div class="provider-grid">
                    <div>
                        <encounterProviderAndRole encounterRole="de11b25c-a641-4630-9524-5b85ece9a4f8"
                                                  providerRoles="39c28f78-6637-4c21-9bf4-db3e2398054f"
                                                  autocompleteProvider="true" required="false" count="2" providerWidgetSeparator="&lt;/div&gt;&lt;div&gt;"/>
                    </div>
                </div>
            </p>
        </div>
    </section>

    <section id="dxProc" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Diagnoses and procedures">

        <div class="section-container">
            <div>
                <div id="data-collection">
                    <encounterDiagnosesByObs selectedDiagnosesTarget="#encounter-diagnoses-target"/>
                </div>

                <div id="encounter-diagnoses-target">
                </div>

                <h3>
                    <uimessage code="Procedures"/>
                </h3>
                <div class="two-columns">
                    <div>
                        <obs conceptId="PIH:Surgical procedure" answerClasses="Procedure" style="autocomplete"/>
                        <obs conceptId="PIH:Surgical procedure" answerClasses="Procedure" style="autocomplete"/>
                        <obs conceptId="PIH:Surgical procedure" answerClasses="Procedure" style="autocomplete"/>
                        <obs conceptId="PIH:Surgical procedure" answerClasses="Procedure" style="autocomplete"/>
                        <obs conceptId="PIH:Surgical procedure" answerClasses="Procedure" style="autocomplete"/>
                    </div>
                    <div></div>
                </div>
            </div>
        </div>
    </section>

    <section id="vitals" sectionTag="fieldset" headerTag="legend"
             headerStyle="title" headerCode="pihcore.vitalSigns">
        <div class="section-container">
            <subform path="configuration/pih/subforms/vital-signs-widget.xml"/>
        </div>
    </section>

    <section id="aldrete" sectionTag="fieldset" headerTag="legend"
             headerStyle="title" headerCode="Aldrete discharge criteria">
        <div class="section-container">
            <repeat>
                <template>
                    <p class="list-inline">
                        <label>
                            <uimessage code="{category}" />
                        </label>
                        <br/>
                        <obs conceptId="CIEL:{qId}" style="radio" answerSeparator="&lt;br /&gt;" />
                    </p>
                </template>
                <render qId="170339" category="Oxygenation"/>
                <render qId="170343" category="Respiration"/>
                <render qId="170347" category="Circulation"/>
                <render qId="162643" category="Level of consciousness"/>
                <render qId="170351" category="Activity"/>
            </repeat>
        </div>
    </section>

    <section id="plan" sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Plan">
        <div class="section-container">
            <p class="side-by-side">
                <div id="disposition">
                    <encounterDisposition />
                </div>
            </p>
        </div>
    </section>
    <br/>

    <ifMode mode="VIEW" include="false">
        <div id="buttons">
            <submit submitClass="confirm right" submitCode="mirebalais.save"/>
            <button type="button" class="cancel">
                <uimessage code="emr.cancel"/>
            </button>
        </div>
    </ifMode>

</htmlform>
